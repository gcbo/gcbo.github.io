<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>FStoneCapture逆向分析</title>
      <link href="/2020/02/18/FStoneCapture%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/"/>
      <url>/2020/02/18/FStoneCapture%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><p><a href="http://www.faststone.org" target="_blank" rel="noopener">FastStone Capture</a> 是一款抓屏工具，体积小巧、功能强大。我也是在不经意间使用下载了此软件，并不知道这是一款商用软件，用了一段时间竟然出现使用结束对话框。<br> <a href="fs试用版本.PNG" data-fancybox="group" data-caption="试用版本" class="fancybox"><img width="40%" alt="试用版本" align="center" title="试用版本" data-src="fs试用版本.PNG" src="/img/loading.gif" class="lazyload"></a></p><p>本着好奇心和认真学习的态度尝试逆向此软件。</p><hr><h1 id="01-样本概况"><a href="#01-样本概况" class="headerlink" title="01-样本概况"></a>01-样本概况</h1><h2 id="1-1-应用程序信息"><a href="#1-1-应用程序信息" class="headerlink" title="1.1-应用程序信息"></a>1.1-应用程序信息</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">软件名称：FastStone Capture</span><br><span class="line">产品版本：9.0</span><br><span class="line">名称: FSCapture.exe</span><br><span class="line">大小: 5668864 字节 (5536 KiB)</span><br><span class="line">CRC32: F37FA650</span><br><span class="line">SHA256: 1D9620FE0004E48CBD382A110AD50EED913C85B7374ED1F02205DA1599460BE6</span><br><span class="line">SHA1: 49F715359E3CB092FFA2DD3432EFDFE1C11C4749</span><br><span class="line">这是一个汉化版本，以下结果英文版也适用。</span><br></pre></td></tr></tbody></table></figure></div><h2 id="1-2-分析环境及工具"><a href="#1-2-分析环境及工具" class="headerlink" title="1.2-分析环境及工具"></a>1.2-分析环境及工具</h2><ul><li>系统环境：Windows10-64位、Windows7-32位</li><li>工具：x64dbg、IDA、IDR-Delphi反编译</li></ul><h2 id="1-3-分析目标"><a href="#1-3-分析目标" class="headerlink" title="1.3-分析目标"></a>1.3-分析目标</h2><ul><li>分析算法</li></ul><h1 id="02-具体分析过程"><a href="#02-具体分析过程" class="headerlink" title="02-具体分析过程"></a>02-具体分析过程</h1><h2 id="2-1-可执行文件信息"><a href="#2-1-可执行文件信息" class="headerlink" title="2.1-可执行文件信息"></a>2.1-可执行文件信息</h2><ul><li>放入PEID<a href="fs_peid.png" data-fancybox="group" data-caption="程序注册框" class="fancybox"><img width="40%" alt="程序注册框" title="程序注册框" data-src="fs_peid.png" src="/img/loading.gif" class="lazyload"></a>Delphi编写，并且无壳。</li><li>运行程序，错误提示<a href="fs_注册框.png" data-fancybox="group" data-caption="错误提示" class="fancybox"><img width="40%" alt="错误提示" title="错误提示" data-src="fs_注册框.png" src="/img/loading.gif" class="lazyload"></a></li></ul><h2 id="2-2"><a href="#2-2" class="headerlink" title="2.2-"></a>2.2-</h2></body></html>]]></content>
      
      
      <categories>
          
          <category> security </category>
          
          <category> reverse engineering </category>
          
      </categories>
      
      
        <tags>
            
            <tag> x64dbg, </tag>
            
            <tag> FastStone Capture </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>格式化字符串漏洞</title>
      <link href="/2020/02/13/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%BC%8F%E6%B4%9E/"/>
      <url>/2020/02/13/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%BC%8F%E6%B4%9E/</url>
      
        <content type="html"><![CDATA[<html><head></head><body><h1 id="格式化字符串漏洞"><a href="#格式化字符串漏洞" class="headerlink" title="格式化字符串漏洞"></a>格式化字符串漏洞</h1><h2 id="printf-函数声明"><a href="#printf-函数声明" class="headerlink" title="printf()函数声明"></a>printf()函数声明</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">printf</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *format, arg1,arg2,arg3,...)</span></span></span><br></pre></td></tr></tbody></table></figure></div><p>format是字符串，其中，每个”%格式化控制符”对应了一个参数列表的参数，用于解释参数如何输出，”%格式化控制符”可以有以下情况：</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">%d - 十进制 - 输出十进制整数</span><br><span class="line">%s - 字符串 - 从内存中读取字符串</span><br><span class="line">%x - 十六进制 - 输出十六进制数</span><br><span class="line">%c - 字符 - 输出字符</span><br><span class="line">%p - 指针 - 指针地址</span><br><span class="line">%n - 计算到目前为止所输出的字符数，写入对应位置的参数，该参数为一个地址</span><br></pre></td></tr></tbody></table></figure></div><h2 id="printf-函数栈结构"><a href="#printf-函数栈结构" class="headerlink" title="printf()函数栈结构"></a>printf()函数栈结构</h2><a href="/2020/02/13/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%BC%8F%E6%B4%9E/printf%E6%A0%88%E7%BB%93%E6%9E%84.PNG" data-fancybox="group" data-caption="undefined" class="fancybox"><img class="lazyload" title="[title]" data-src="/2020/02/13/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%BC%8F%E6%B4%9E/printf%E6%A0%88%E7%BB%93%E6%9E%84.PNG" src="/img/loading.gif"></a></body></html>]]></content>
      
      
      <categories>
          
          <category> security </category>
          
          <category> string format </category>
          
      </categories>
      
      
        <tags>
            
            <tag> printf </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
